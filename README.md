### ‡πÄ‡∏ß‡πá‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏•‡∏≤‡∏Å‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏∏‡∏®‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡πà‡∏≤‡∏ô
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏•‡∏≤‡∏Å‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏∏‡∏®‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡πà‡∏≤‡∏ô
- ‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ‡∏Ç‡∏≠‡∏á‡∏î‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô 
  
### ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ 
- ‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤ PHP ‡πÅ‡∏•‡∏∞ Javascript 
- ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ç‡∏≠‡∏á Container (Docker) ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÅ‡∏•‡∏∞ ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞ ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ 
- ‡πÑ‡∏î‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠ ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á OCR (Optical Character Recognition) ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ ‡πÄ‡πÄ‡∏•‡πâ‡∏ß
- ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ ‡∏£‡∏≤‡∏ä‡∏°‡∏á‡∏Ñ‡∏•‡∏•‡πâ‡∏≤‡∏ô‡∏ô‡∏≤ ‡∏ô‡πà‡∏≤‡∏ô 
## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ß‡πá‡∏ö
- ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö 
![‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö](./documents/doc.gif)

- ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏î‡∏¢ OCR
![‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏î‡∏¢ OCR](./documents/ocr.gif)
# ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå
```mermaid
graph LR
    A[‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö] <--> B[‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô]
    B <--> GOOGLE[Google Cloud]
    B <--> MYSQL[MySQL]
    C[‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô] <--> A
    admin[‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö] --> crud[CRUD]
    crud --> MYSQL
    
```
# ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á environment ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Depoly
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Docker ‡πÅ‡∏•‡∏∞ Docker Compose ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á 
```bash 
sudo apt-get update 
sudo apt-get install docker.io -y 
sudo apt-get install docker-compose -y 
```
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Docker ‡πÅ‡∏•‡∏∞ Docker Compose
```bash
docker --version
docker-compose --version
```
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° webserver ngingx ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
```bash
sudo apt-get install nginx
```
- ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô nginx ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå
```bash
sudo systemctl start nginx
sudo systemctl enable nginx
```
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö ngnix  
```bash  
sudo systemcmt status nginx 
```
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Certbot
```bash
sudo apt install certbot python3-certbot-nginx
```
- ‡∏Ç‡∏≠‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Certbot ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á SSL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏î‡πÄ‡∏°‡∏ô `You-Domain`:
```bash 
sudo certbot --nginx -d You-Domain
```
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ NGINX ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Node.js 
```bash
sudo vim /etc/nginx/sites-available/you-domain
```
- config ‡πÑ‡∏ü‡∏•‡πå nginx ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå default ‡πÉ‡∏ô /etc/nginx/sites-available/you-domain
```bash
server {
    listen 80;
    server_name You-Domain;

    # Redirect all traffic to HTTPS
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name You-Domain;

    ssl_certificate /etc/letsencrypt/live/You-Domain/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/You-Domain/privkey.pem;

    location /api_recross_ocr/ {
        proxy_pass http://localhost:3000/api_recross_ocr/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á NGINX
```bash 
sudo ln -s /etc/nginx/sites-available/You-Domain /etc/nginx/sites-enabled/
```
-  ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ NGINX
```bash 
sudo nginx -t
```
- ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó NGINX
```bash 
sudo systemctl restart nginx
```
# ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ Deployment 
- clone ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏à‡∏≤‡∏Å github 
```bash
git clone https://github.com/JeerasakAnanta/redcross_lottery_nan.git
cd redcross_lottery_nan 
```
- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå .env.example ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå .env
```bash
cp .env.example .env
```
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå .env ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏≠‡∏á
```bash
# API keys

# Other configuration
SECRET_KEY=your_secret_key

# Node configuration
NODE_PORT=3000

# MySQL configuration
MYSQL_PORT=3306
MYSQL_DATABASE=yoursql_db
MYSQL_USERNAME=yoursql_user
MYSQL_PASSWORD=yoursql_password
MYSQL_ROOT_PASSWORD=yoursql_root_password

# Google Cloud configuration ü§ë
GOOGLE_PROJECT_ID=...
GOOGLE_PRIVATE_KEY_ID=...
GOOGLE_PRIVATE_KEY=...
GOOGLE_CLIENT_EMAIL=...
GOOGLE_CLIENT_ID=...
GOOGLE_CLIENT_X509_CERT_URL=...
```

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Docker ‡∏ú‡πà‡∏≤‡∏ô bash script üßô‚Äç‚ôÇÔ∏è
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ bash script (Magic install script) 
```bash
chmod +x build_docker.sh
```
- ‡∏£‡∏±‡∏ô‡πÑ‡∏ü‡∏•‡πå
```bash
./build_docker.sh
```
## ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà
- web (user) http://your-ip-address
- web (admin) http://your-ip-address/admin
- phpmyadmin http://your-ip-address:8080
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô docker ‡πÉ‡∏ô docker desktop
![dockerps](/documents/dockerps.png)
## ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• MySQL
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠ db ‡πÉ‡∏ô http://your-ip-address:8080
```sql
    CREATE DATABASE lotteries;
```
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠ lottery  ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠  db
```sql
    CREATE TABLE lottery (
    id INT AUTO_INCREMENT PRIMARY KEY,              -- ‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
    lottery_number VARCHAR(20) NOT NULL,            -- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏™‡∏•‡∏≤‡∏Å (‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó String)
    reward_number VARCHAR(20) NOT NULL,             -- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó String)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP  -- ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
);
```
## ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Frontend ‡πÅ‡∏•‡∏∞ Backend API ‡∏Å‡∏±‡∏ö MySQL
```mermaid
sequenceDiagram
    participant User
    participant Frontend (PHP)
    participant Backend API
    participant MySQL (db)
    participant phpMyAdmin
    participant Admin 

    User->>Frontend (PHP): ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏´‡∏£‡∏∑‡∏≠ API call)
    Frontend (PHP)->>MySQL (db): ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ú‡πà‡∏≤‡∏ô mysqli (‡πÉ‡∏ä‡πâ host='db')
    Frontend (PHP)->>Backend API: ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
    Backend API->>MySQL (db): ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ú‡πà‡∏≤‡∏ô MySQL Driver (host='db')
    phpMyAdmin->>MySQL (db): ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ú‡πà‡∏≤‡∏ô PMA_HOST='db'
    MySQL (db)-->>Frontend (PHP): ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö
    Frontend (PHP)-->>User: ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

    Admin->>phpMyAdmin: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

``` 
## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô  Microservices Architecture
``` mermaid 
graph TD
    subgraph Microservices Architecture
        frontend[Frontend Service] -->|HTTP Requests| backend[Backend API Service]
        backend -->|Database Queries| db[(Database Service)]
        backend -->|Monitoring Data| prometheus[Prometheus Service]
        prometheus -->|Visualization| grafana[Grafana Service]
        db -->|Manage via| phpmyadmin[phpMyAdmin Service]
    end

    subgraph Networks
        redcorss-network[redcorss-network: bridge]
    end

    subgraph Volumes
        db_data[db_data]
    end

    frontend -->|Network| redcorss-network
    backend -->|Network| redcorss-network
    db -->|Network| redcorss-network
    phpmyadmin -->|Network| redcorss-network
    grafana -->|Network| redcorss-network
    prometheus -->|Network| redcorss-network
    db -->|Volume| db_data
```

## ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÇ‡∏î‡∏¢ 
- [Jeerasak Ananta SS4](https://github.com/JeerasakAnanta) üçª
- [Prachya](https://github.com/pabigmz)üöÄ

## Mockup Database 
```sql
INSERT INTO lotterys (lottery_number, reward_number, createdAt, updatedAt) VALUES
('132137', 1, NOW(), NOW()),
('035158', 2, NOW(), NOW()), 
('129715', 3, NOW(), NOW()),
('018415', 3, NOW(), NOW()), 
('179006', 3, NOW(), NOW()),
('089491', 3, NOW(), NOW()), 
('155484', 3, NOW(), NOW()),
('065089', 4, NOW(), NOW()), 
('092932', 4, NOW(), NOW()), 
('090780', 4, NOW(), NOW()), 
('044492', 4, NOW(), NOW()), 
('059714', 4, NOW(), NOW()), 
('085243', 4, NOW(), NOW()), 
('115367', 4, NOW(), NOW()),
('101048', 4, NOW(), NOW()),
('020822', 4, NOW(), NOW()), 
('072170', 4, NOW(), NOW()), 
('068937', 5, NOW(), NOW()), 
('104411', 5, NOW(), NOW()),
('010620', 5, NOW(), NOW()), 
('159264', 5, NOW(), NOW()),
('046552', 5, NOW(), NOW()), 
('006447', 5, NOW(), NOW()), 
('052871', 5, NOW(), NOW()), 
('104119', 5, NOW(), NOW()),
('105607', 5, NOW(), NOW()),
('032510', 5, NOW(), NOW()), 
('067427', 6, NOW(), NOW()), 
('075772', 6, NOW(), NOW()), 
('086856', 6, NOW(), NOW()), 
('163530', 6, NOW(), NOW()),
('067874', 6, NOW(), NOW()), 
('161096', 6, NOW(), NOW()),
('118997', 6, NOW(), NOW()),
('170573', 6, NOW(), NOW()),
('060817', 6, NOW(), NOW()), 
('040482', 6, NOW(), NOW()), 
('086004', 6, NOW(), NOW()), 
('198791', 6, NOW(), NOW()),
('071681', 6, NOW(), NOW()), 
('114796', 6, NOW(), NOW()),
('161044', 6, NOW(), NOW()),
('000186', 7, NOW(), NOW()); 
```